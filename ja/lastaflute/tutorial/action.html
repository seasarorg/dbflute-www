<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja" >
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta name="keywords" content="DBFlute,LastaFlute" />
	<link rel="stylesheet" type="text/css" href="../../../css/sub.css" />
	<!--[if IE 6.0]>
		<link rel="stylesheet" type="text/css" href="../../../css/cb/sub.css" />
	<![endif]--> 
	<title>LastaAction Tutorial | LastaFlute</title>
</head>
<body>
<div id="container" class="ct-tutorial">

<div id="mainbar">
<div id="header">
	<div class="navi-upper"><a href="../../../ja/sitemap.html">SiteMap</a>|<a href="http://d.hatena.ne.jp/jflute/">Author's Blog</a></div>
	<div class="navi-main">
	<ul>
		<li class="hd-introduction"><a href="../../../ja/introduction/index.html"><img src="../../../image/parts/navi/link-intro.png" alt="Introduction" width="75" height="32" /></a></li>
		<li class="hd-tutorial"><a href="../../../ja/tutorial/index.html"><img src="../../../image/parts/navi/link-tuto.png" alt="Tutorial" width="56" height="24" /></a>
			<ul>
				<li class="hd-architect"><a href="../../../ja/tutorial/architect.html"><img src="../../../image/parts/navi/link-arch.png" alt="for Architect" width="80" height="24" /></a></li>
				<li class="hd-developer"><a href="../../../ja/tutorial/developer.html"><img src="../../../image/parts/navi/link-dev.png" alt="for Developer" width="87" height="24" /></a></li>
			</ul>
		</li>
		<li class="hd-environment"><a href="../../../ja/environment/index.html"><img src="../../../image/parts/navi/link-env.png" alt="Environment" width="84" height="25" /></a>
			<ul>
				<li class="hd-install"><a href="../../../ja/environment/setup/index.html"><img src="../../../image/parts/navi/link-setup.png" alt="Setup" width="42" height="24" /></a></li>
				<li class="hd-upgrade"><a href="../../../ja/environment/upgrade/index.html"><img src="../../../image/parts/navi/link-upgrade.png" alt="Upgrade" width="61" height="25" /></a></li>
			</ul>
		</li>
		<li class="hd-manual"><a href="../../../ja/manual/index.html"><img src="../../../image/parts/navi/link-manual.png" alt="Manual" width="62" height="25" /></a></li>
	</ul>
	</div>
</div>

<div id="content">
	<h1>LastaAction Tutorial</h1>
	<ul class="indexlist">
		<li><a href="#urlmapping">URL Mapping</a></li>
		<li><a href="#pkglocation">Action Package</a>
			<ul>
				<li><a href="#pkgconvention">Package Convention</a></li>
				<li><a href="#pkgexample">Package Example</a></li>
			</ul>
		</li>
		<li><a href="#makeaction">make Action Class</a>
			<ul>
				<li><a href="#actiondef">Action Defintion</a></li>
				<li><a href="#urlparam">URL Parameter</a></li>
				<li><a href="#executeparam">Action Form <span class="frm">(for POST, GET parameter)</span></a></li>
				<li><a href="#executeret">Execute Return</a></li>
				<li><a href="#templatepath">TemplatePath FreeGen <span class="frm">(if use)</span></a></li>
			</ul>
		</li>
	</ul>

	<h2 id="urlmapping">URL Mapping</h2>
	<h3 id="bigconvention">Mapping Convention <span class="frm">(Big convention)</span></h2>
	<dl class="valuemainlist">
		<dt>Request URL</dt><dd><em class="mark">Action</em> class + <em class="mark">Execute</em> method</dd>
	</dl>
	<h3 id="mapping">Mapping Example</h2>
	<dl class="lolongkeymainlist">
		<dt><em class="bigmark">ProfilePassword</em>Action#<em class="mark">change</em>()</dt>
		<dd><em class="keyword">/profile/password/change/</em></dd>
		<dt><em class="bigmark">Product</em>Action#<em class="mark">list</em>()</dt>
		<dd><em class="keyword">/product/list/</em></dd>
		<dt><em class="bigmark">ProductList</em>Action#index()</dt>
		<dd><em class="keyword">/product/list/</em></dd>
		<dt><em class="bigmark">Mypage</em>Action#index()</dt>
		<dd><em class="keyword">/mypage/</em></dd>
		<dt><em class="bigmark">Root</em>Action#index()</dt>
		<dd><em class="keyword">/ <span class="frm">※Special Action means URL '/'</span></em></dd>
	</dl>

	<h2 id="pkglocation">Action Package</h2>
	<h3 id="pkgconvention">Package Convention</h3>
	<dl class="valuemainlist">
		<dt>Application Package</dt><dd>[your domain].app <span class="frm">e.g. org.docksidestage.app</span></dd>
		<dt>Web Package</dt><dd>[Application Root].web <span class="frm">e.g. org.docksidestage.app.web</span></dd>
		<dt>Action's Package</dt><dd>*you can use Action's prefix package</dd>
	</dl>
	<h3 id="pkgexample">Package Example</h3>
	<p>
		You can choose several pattern like this: e.g. ProfilePasswordAction
	</p>
	<ul>
		<li>[Application Root].web.ProfilePasswordAction#change()</li>
		<li>[Application Root].web.<em class="smallmark">profile</em>.<em class="mark">Profile</em>PasswordAction#change() <span class="frm">*recommended</span></li>
		<li>[Application Root].web.<em class="smallmark">profile.password</em>.<em class="mark">ProfilePassword</em>Action#change()</li>
	</ul>

<pre><span class="codetitle">e.g. Action Class Package Location @Directory</span><code>
org.docksidestage
 |-<span class="point">app</span> <span class="comment">// Application Package</span>
 |  |-logic
 |  |-<span class="point">web</span> <span class="comment">// Web Package</span>
 |     |-product
 |     |  |-<span class="subpoint">ProductListAction</span>
 |     |  |-ProductPurchaseAction
 |     |-profile
 |     |  |-<span class="subpoint">ProfilePasswordAction</span>
 |     |  |-ProfileWithdrawalAction
 |     |-mypage
 |     |  |-<span class="subpoint">MypageAction</span>
 |     |-RootAction
 |-dbflute
 |  |-allcommon
 |  |-bsbhv
 |  |-<span class="abbreviation">...</span>
 |-mylasta
 |  |-action
 |  |-direction
 |  |-<span class="abbreviation">...</span>
</code></pre>

	<h2 id="makeaction">make Action Class</h2>
	<h3 id="actiondef">Action Defintion</h3>
	<dl class="valuemainlist">
		<dt>Super Class</dt><dd>extends [App]BaseAction</dd>
		<dt>Behavior DI</dt><dd>instance variable with @Resource</dd>
		<dt>Execute Method</dt><dd>public method with @Execute</dd>
	</dl>
<pre><span class="codetitle">e.g. Action Class Definition @Java</span><code>
<span class="keyword">public class</span> ProductListAction <span class="keyword">extends</span> DocksideBaseAction { <span class="comment">// Super Class</span>

    @Resource
    <span class="keyword">private</span> ProductBhv <span class="attribute">productBhv</span>; <span class="comment">// Behavior DI</span>

    @Execute
    <span class="keyword">public</span> HtmlResponse index() { <span class="comment">// Execute Method</span>
        <span class="abbreviation">...</span>
    }
}
</code></pre>
	<h3 id="urlparam">URL Parameter</h3>
	<p>
		e.g. ProductListAction#index()
	</p>
<pre><span class="codetitle">e.g. accept URL parameter as required argument @Java</span><code>
    @Execute
    <span class="keyword">public</span> HtmlResponse index(<span class="point">int pageNumber</span>) { <span class="comment">// /product/list/3/</span>
        <span class="abbreviation">...</span>
    }
</code></pre>
<pre><span class="codetitle">e.g. accept URL parameter as optional argument @Java</span><code>
    @Execute
    <span class="keyword">public</span> HtmlResponse index(<span class="point">OptionalThing&lt;Integer&gt; pageNumber</span>) {
        pageNumber.ifPresent(() -&gt; { <span class="comment">// /product/list/3/</span>
            <span class="abbreviation">...</span>
        }).orElse(() -&gt; { <span class="comment">// /product/list/</span>
            <span class="abbreviation">...</span>
        });
    }
</code></pre>
<pre><span class="codetitle">e.g. accept URL parameter with more URL @Java</span><code>
    <span class="comment">// /product/list/mystic/ikspiary/oneman/</span> <span class="comment">(sea=mystic, land=oneman)</span>
    @Execute(<span class="subpoint">urlPattern</span> = <span class="literal">"{}/ikspiary/{}"</span>)
    <span class="keyword">public</span> HtmlResponse index(<span class="subpoint">String sea, String land</span>) {
        <span class="abbreviation">...</span>
    }
</code></pre>
	<h3 id="executeparam">Action Form <span class="frm">(for POST, GET parameter)</span></h3>
<pre><span class="codetitle">e.g. accept POST parameter by action form @Java</span><code>
    @Execute
    <span class="keyword">public</span> HtmlResponse doSignin(<span class="point">SinginForm form</span>) { <span class="comment">// submit</span>
        <span class="abbreviation">...</span>
    }
</code></pre>
<pre><span class="codetitle">e.g. both URL parameter and POST parameter @Java</span><code>
    <span class="comment">// e.g. /<span class="abbreviation">...</span>/list/3/?favoriteCode=sea&nextName=land</span>
    @Execute
    <span class="keyword">public</span> HtmlResponse list(<span class="subpoint">Integer pageNumber</span>, <span class="subpoint">SinginForm form</span>) {
        <span class="abbreviation">...</span>
    }
</code></pre>
	<h3 id="executeret">Execute Return</h3>
	<dl class="valuemainlist">
		<dt>HtmlResponse</dt><dd>asHtml(path_...) <span class="frm">*with FreeGen</span></dd>
		<dt>JsonResponse</dt><dd>asJson(bean)</dd>
		<dt>StreamResponse</dt><dd>asStream(ins)</dd>
	</dl>
<pre><span class="codetitle">e.g. HtmlResponse @Java</span><code>
    @Execute
    <span class="keyword">public</span> HtmlResponse index() {
        <span class="abbreviation">...</span>
        <span class="keyword">return</span> <span class="point">asHtml</span>(<span class="attribute">path_MyPage_MyPageJsp</span>);
    }
</code></pre>
<pre><span class="codetitle">e.g. JsonResponse @Java</span><code>
    @Execute
    <span class="keyword">public</span> JsonResponse product() {
        ProductBean <span class="localvar">bean</span> = <span class="abbreviation">...</span>
        <span class="keyword">return</span> <span class="point">asJson</span>(<span class="localvar">bean</span>);
    }
</code></pre>
	<h3 id="templatepath">TemplatePath FreeGen <span class="frm">(if use)</span></h3>
	<p>
		まず、テンプレートファイル (e.g. JSP) を作成 <span class="frm">(まだ空っぽでもOK)</span>
	</p>
	<dl class="longvaluemainlist">
		<dt>ファイル名</dt><dd>Formタグが飛ばすURLに対応 <span class="frm">※ボタン名は除外</span></dd>
		<dt>配置ディレクトリ</dt><dd>ファイル名のprefix</dd>
	</dl>
	<p>
		la:form で action属性を省略したときにリクエストされるURL。
	</p>
	<dl class="lolongkeymainlist">
		<dt>product/<em class="mark">product_list</em>.jsp</dt><dd>/product/list/</dd>
		<dt>profile/<em class="mark">profile_password_change</em>.jsp</dt><dd>/profile/password/change/</dd>
		<dt>mypage/<em class="mark">mypage</em>.jsp</dt><dd>/mypage/</dd>
	</dl>
	<p>
		そして、DBFlute の FreeGen を叩く！すると、パス定義が自動生成されて補完できるようになる。
	</p>
<pre><span class="codetitle">e.g. Template File Location @Directory</span><code>
src/main/webapp
 |-WEB-INF
    |-view <span class="comment">// HtmlTemplateの配置場所</span>
    |  |-product <span class="comment">// productパッケージに対応</span>
    |  |  |-<span class="subpoint">product_list.jsp</span>     <span class="comment">// /product/list/</span>
    |  |  |-product_purchase.jsp <span class="comment">// /product/purchase/</span>
    |  |
    |  |-profile
    |  |  |-<span class="subpoint">profile_password_change.jsp</span> <span class="comment">// /profile/password/change/</span>
    |  |  |-profile_withdrawal.jsp      <span class="comment">// /profile/withdrawal/</span>
    |  |
    |  |-mypage
    |  |  |-<span class="subpoint">mypage.jsp</span> <span class="comment">// /mypage/</span>
    |  |
    |  |-root.jsp <span class="comment">// '/'</span>
    |
    |-web.xml
</code></pre>
<pre><span class="codetitle">e.g. you can use Template Path for HtmlResponse @Java</span><code>
    @Execute
    <span class="keyword">public</span> HtmlResponse index() {
        <span class="abbreviation">...</span>
        <span class="keyword">return</span> asHtml(<span class="point">path_Mypage_MypageJsp</span>); <span class="comment">// is static definition</span>
    }
</code></pre>

</div>
</div>

<div id="sidebar">
	<div class="logo"><a href="../../../"><img src="../../../image/parts/logo.png" alt="dbflute-logo" width="240" height="110" /></a></div>
<ul>
		<li><a href="../../../ja/introduction/index.html">DBFluteの紹介</a>
			<ul>
				<li><a href="../../../ja/introduction/index.html#about">DBFluteとは？</a></li>
				<li><a href="../../../ja/introduction/index.html#ormapper">O/Rマッパー</a></li>
				<li class="upper-space"><a href="../../../ja/introduction/index.html#dbmanage">DB管理支援ツール</a></li>
				<li><a href="../../../ja/introduction/index.html#welcome">DBFluteの世界へ</a></li>
				<li><a href="../../../ja/introduction/index.html#thanks">Thanks, Frameworks</a></li>
			</ul>
		</li>
		<li><a href="../../../ja/introduction/gendriven.html">自動生成ドリブン</a>
		</li>
		<li><a href="../../../ja/introduction/dbaccessif.html">バランス重視のDBアクセス</a>
		</li>
		<li><a href="../../../ja/introduction/performance.html">パフォーマンス考慮</a>
		</li>
	</ul>

</div>

<div id="footer">
	<div><a href="../../../ja/sitemap.html">SiteMap</a> <a href="http://d.hatena.ne.jp/jflute">Author's Blog</a><a href="https://www.seasar.org/issues/browse/DBFLUTE">BTS</a></div>
	<ul class="footer-navi">
		<li class="hd-introduction"><a href="../../../ja/introduction/index.html">Introduction</a></li>
		<li class="hd-tutorial"><a href="../../../ja/tutorial/index.html">Tutorial</a>
			<ul>
				<li class="hd-architect"><a href="../../../ja/tutorial/architect.html">for Architect</a></li>
				<li class="hd-developer"><a href="../../../ja/tutorial/developer.html">for Developer</a></li>
			</ul>
		</li>
		<li class="hd-environment"><a href="../../../ja/environment/index.html">Environment</a>
			<ul>
				<li class="hd-install"><a href="../../../ja/environment/setup/index.html">Setup</a></li>
				<li class="hd-upgrade"><a href="../../../ja/environment/upgrade/index.html">Upgrade</a></li>
			</ul>
		</li>
		<li class="hd-manual"><a href="../../../ja/manual/index.html">Manual</a></li>
	</ul>

</div>

</div>
</body>
</html>
